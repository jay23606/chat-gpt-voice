<!-- https://jay23606.github.io/chat-gpt-voice/html/RNN.html -->

<!DOCTYPE html>
<html>
  <head>
    <title>Simple RNN Example</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.1.0"></script>
    <script>
      // Define training data
      const input = ["cat", "dog", "bird"];
      const output = ["f", "b", "w"];

      // Define model architecture
      const model = tf.sequential();
      model.add(tf.layers.simpleRNN({
        units: 3,
        inputShape: [1, 3]
      }));
      model.add(tf.layers.dense({units: 1}));

      // Compile the model
      model.compile({
        optimizer: "sgd",
        loss: "meanSquaredError"
      });

      // Train the model
      const xs = tf.transpose(tf.tensor3d(input.map(word => [[word.charCodeAt(0)], [word.charCodeAt(1)], [word.charCodeAt(2)]])), [1, 0, 2]);
      const ys = tf.tensor2d(output.map(word => [word.charCodeAt(0)]));
      model.fit(xs, ys, {epochs: 100});

      // Predict the next word
      const inputWord = "fox";
      const inputWordCharCode = [[inputWord.charCodeAt(0)], [inputWord.charCodeAt(1)], [inputWord.charCodeAt(2)]];
      const inputTensor = tf.tensor3d(inputWordCharCode, [1, 3, 1]);
      const transposedInputTensor = tf.transpose(inputTensor, [0, 2, 1]);
      const prediction = model.predict(transposedInputTensor);
      const roundedPrediction = prediction.dataSync();
      const nextCharCode = Math.round(roundedPrediction[0]);
      const nextChar = String.fromCharCode(nextCharCode);
      console.log("Next word: " + inputWord + nextChar);

    </script>
  </head>
  <body>
    <h1>Simple RNN Example</h1>
  </body>
</html>
