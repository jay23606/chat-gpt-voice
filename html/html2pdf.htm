<!-- https://jay23606.github.io/chat-gpt-voice/html/html2pdf.htm -->
<!DOCTYPE html>
<html>
<body>
<style>
p{ color: blue }
</style>
<div class="section-to-capture">
    <h1>Sample Section1</h1>
    <pre>This is some sample content that will be captured and converted into a PDF. This is some sample content that will be captured and converted into a PDF.</pre>
	<p>ThisissomesamplecontentthatwillbecapturedandconvertedintoaPDFThisissomesamplecontentthatwillbecapturedandconvertedintoaPDFThisissomesamplecontentthatwillbecapturedandconvertedintoaPDF</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
</div>
<div class="section-to-capture">
    <h1>Sample Section2</h1>
    <pre>This is some sample content that will be captured and converted into a PDF. This is some sample content that will be captured and converted into a PDF.</pre>
	<p>ThisissomesamplecontentthatwillbecapturedandconvertedintoaPDFThisissomesamplecontentthatwillbecapturedandconvertedintoaPDFThisissomesamplecontentthatwillbecapturedandconvertedintoaPDF</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
</div>
<div class="section-to-capture">
    <h1>Sample Section3</h1>
    <pre>This is some sample content that will be captured and converted into a PDF. This is some sample content that will be captured and converted into a PDF.</pre>
	<p>ThisissomesamplecontentthatwillbecapturedandconvertedintoaPDFThisissomesamplecontentthatwillbecapturedandconvertedintoaPDFThisissomesamplecontentthatwillbecapturedandconvertedintoaPDF</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
	<p>This is some sample content that will be captured and converted into a PDF.</p>
</div>

<button onclick="generatePDF()">Generate PDF</button>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>

const generatePDF = (sel = '.section-to-capture', scale = 1, margins = 0.5, orientation = 'landscape') => {
    const elements = document.querySelectorAll(sel);
    const { jsPDF } = window.jspdf;
    const pageSize = orientation === 'portrait' ? { width: 8.5 * 72, height: 11 * 72 } : { width: 11 * 72, height: 8.5 * 72 };
    const marginSize = margins * 72;
    const marginValues = { top: marginSize, bottom: marginSize, left: marginSize, right: marginSize };

    const pdf = new jsPDF({
        orientation: orientation, 
        unit: 'pt', 
        format: [pageSize.width, pageSize.height], 
        margins: marginValues
    });

    elements.forEach((el, index) => {
	const w = el.scrollWidth + 17, h = el.scrollHeight;
        const scaleFactor = Math.min(
            (pageSize.width - marginValues.left - marginValues.right) / w,
            (pageSize.height - marginValues.top - marginValues.bottom) / h
        );
        const canvasWidth = w * scaleFactor;
        const canvasHeight = h * scaleFactor;
        html2canvas(el, { scale: scale, width: w, height: h }).then(canvas => {
            if (index !== 0) pdf.addPage();
            const imgData = canvas.toDataURL('image/png');
            pdf.addImage(imgData, 'PNG', marginValues.left, marginValues.top, canvasWidth, canvasHeight);
            if (index === elements.length - 1) pdf.save('output.pdf');
        });
    });
};
    </script>
</body>
</html>
